---

# Bank Nifty SPAN Margin Parser

A Python-based utility to parse **NSE NSCCL SPAN risk parameter files** (`.zip` / `.spn`) for **Bank Nifty** and output clean CSVs for backtesting and margin analysis Python tool to parse NSE SPAN risk parameter files for Bank Nifty options**. This parser extracts detailed **risk arrays, SPAN margins, and exposure margins** from NSCCL `.zip` or `.spn` files and generates **CSV outputs** ready for trading analysis, backtesting, or margin calculations.

It is designed for **traders, analysts, and developers** who need a reliable way to process NSE SPAN data and understand option chain risk and margin requirements.

It includes **sample input files**, **expected output files**, and a **ready-to-run parser script**.

![Python Version](https://img.shields.io/badge/python-3.7+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

---

## üìÇ Repository Structure

```
Span Risk Parameter File/
‚îú‚îÄ‚îÄ README-template.md       # This documentation
‚îú‚îÄ‚îÄ gitignore-template.txt   # Git ignore template
‚îú‚îÄ‚îÄ Sample/                  # Example NSE ZIP/SPN files for testing
‚îú‚îÄ‚îÄ Test/                    # Example output CSVs from the parser
‚îî‚îÄ‚îÄ src/                     # Python script for parsing
```

**Folder purpose:**

* **`Sample/`** ‚Üí Input files (NSE-provided zips or extracted `.spn` files)
* **`Test/`** ‚Üí Example output CSVs generated by the parser
* **`src/`** ‚Üí Core parser script (`extract_banknifty_span.py`)
```bash
 You can also Directly Donwload Risk Parameter File  from here https://www.nseindia.com/all-reports-derivatives, just select date and then ready to go !!
```


---

## ‚ú® Features

* **Handles NSE NSCCL `.zip` and `.spn` formats** directly
* Extracts **expiry, strike, option type, premiums, deltas, SPAN & exposure margins**
* Outputs clean, analysis-ready CSVs
* **Zero external dependencies** ‚Äì Python standard library only
* **Sample files included** for instant testing

---

## üìã Requirements

* Python **3.7+**
* Works on **Windows / macOS / Linux**
* No external packages needed

---

## üöÄ Quick Start

### 1. Clone the repository

```bash
git clone https://github.com/
lakshyaverma2414/banknifty-span-parser.git
cd banknifty-span-parser
```

### 2. Test with provided sample files

```bash
cd src
python extract_banknifty_span.py ../Sample/nsccl.20250813.i2.zip
```

Output will be created in the **current directory** as `span_began.csv`.

---

## üìä Output Columns

| Column               | Description                      |
| -------------------- | -------------------------------- |
| expiry\_raw          | Original expiry date in file     |
| expiry               | Expiry date (YYYY-MM-DD)         |
| strike               | Strike price                     |
| type                 | Option type (C/P)                |
| premium\_in\_rpf     | Option premium                   |
| delta\_in\_rpf       | Delta value                      |
| worst\_RA\_per\_unit | Worst-case risk array per unit   |
| span\_per\_lot       | SPAN margin per lot              |
| spot\_from\_rpf      | Spot price from file             |
| lot\_size            | Lot size                         |
| notional             | Notional value (spot √ó lot size) |
| exposure\_X.XX\_pct  | Exposure margin                  |
| total\_X.XX\_pct     | Total margin (SPAN + Exposure)   |

---

## ‚öôÔ∏è Script Configuration

Open `src/extract_banknifty_span.py` and modify these defaults if needed:

```python
INPUT_PATH = "../Sample/nsccl.20250813.i2.zip"
OUTPUT_CSV = "span_began.csv"
SYMBOL = "BANKNIFTY"
EXPOSURE_RATES = [0.02, 0.02265]  # 2% and 2.265%
FALLBACK_LOT = 35
```

---

## üìù Example Run

```bash
‚úÖ Wrote 156 option rows to span_began.csv
Underlying spot: 51250.75 | Lot size: 35
Example rows:
expiry,strike,type,premium_in_rpf,...
2025-08-28,51000,C,856.45,...
```

---

## üîß Technical Notes

* Automatically extracts `.spn` from `.zip`
* Processes **16-element SPAN risk arrays**
* Handles **Latin-1 encoded** NSE files
* Continues processing even if some rows fail

---

## üìå Contributing

1. Fork the repo
2. Create a feature branch
3. Submit a PR with changes

---

## üìÑ License

MIT License ‚Äì see [LICENSE](LICENSE)

---

## ‚ö†Ô∏è Disclaimer

For **educational/research purposes only**.
Always confirm margin calculations with your broker before trading.

---

**Made with ‚ù§Ô∏è for the Indian derivatives trading community, Let's make something Awesome**

---

